{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning",
      "ExchangeWebAdmin": "Debug"
    }
  },
  "AllowedHosts": "*",

  "JwtSettings": {
    "SecretKey": "ExchangeWebAdmin-JWT-Secret-Key-2026-MinLength32!",
    "Issuer": "ExchangeWebAdmin",
    "Audience": "ExchangeWebAdminUI",
    "ExpirationHours": 8
  },

  "ExchangeSettings": {
    "ServerFqdn": "outlook.pdulab.ovh",
    "UseSSL": true,
    "ConnectionUri": "https://outlook.pdulab.ovh/PowerShell",
    "ConfigurationName": "Microsoft.Exchange",
    "Authentication": "Basic",
    "SessionPoolSize": {
      "Min": 2,
      "Max": 10
    },
    "TimeoutSeconds": 60,
    "RetryAttempts": 3
  },

  "ExchangeInfrastructures": [
    {
      "Id": "exchange2010",
      "Label": "Exchange 2010 — PDU-LAB",
      "Version": "Exchange 2010",
      "ServerFqdn": "outlook.pdulab.ovh",
      "ConnectionUri": "https://outlook.pdulab.ovh/PowerShell",
      "ConfigurationName": "Microsoft.Exchange",
      "Authentication": "Basic"
    },
    {
      "Id": "exchangese",
      "Label": "Exchange SE — Prophane",
      "Version": "Exchange SE",
      "ServerFqdn": "outlook.prophane.net",
      "ConnectionUri": "https://outlook.prophane.net/PowerShell/",
      "ConfigurationName": "Microsoft.Exchange",
      "Authentication": "Basic",
      "UseLocalShell": false
    }
  ],
  
  "CorsSettings": {
    "AllowedOrigins": [
      "http://localhost:3000",
      "http://localhost:5173",
      "https://localhost:3000",
      "https://localhost:5173"
    ],
    "AllowCredentials": true
  },
  
  "CacheSettings": {
    "DefaultExpirationMinutes": 5,
    "MailboxListExpirationMinutes": 2,
    "DatabaseListExpirationMinutes": 10
  },

  "HealthChecker": {
    "ResultsPath": "C:\\Logs\\ExchangeHealthChecker"
  },
  
  "SecuritySettings": {
    "RequireHttps": false,
    "EnableAuditLog": true,
    "AuditLogPath": "C:\\Logs\\ExchangeWebAdmin",
    "EnableRateLimiting": true,
    "RateLimitPerMinute": 60
  },
  
  "Serilog": {
    "Using": [ "Serilog.Sinks.File" ],
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "System": "Warning"
      }
    },
    "WriteTo": [
      {
        "Name": "File",
        "Args": {
          "path": "C:\\Logs\\ExchangeWebAdmin\\api-.log",
          "rollingInterval": "Day",
          "retainedFileCountLimit": 30,
          "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {Message:lj}{NewLine}{Exception}"
        }
      }
    ]
  }
}
